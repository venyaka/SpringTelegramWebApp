<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Telegram WebApp Auth</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body, html {
            height: 100%;
        }
    </style>
</head>
<body class="bg-light d-flex justify-content-center align-items-center">

<div class="container text-center">
    <h1 class="display-4 mb-4">Добро пожаловать!</h1>

    <!-- Telegram Widget -->
    <script async src="https://telegram.org/js/telegram-widget.js?22"
            data-telegram-login="test_project_spring_telegram_bot"
            data-size="large"
            data-onauth="onTelegramAuth(user)"
            data-request-access="write"></script>
</div>

<!-- Bootstrap JS (optional) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script type="text/javascript">
    function onTelegramAuth(user) {
        const path = "[[${ngrokUrl}]]";
        fetch((path + "/authorize/login"), {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(user)
        })
            .then(response => response.json())
            .then(data => {
                window.location.href = data.redirectUrl;
            });
    }
</script>

</body>
</html>
